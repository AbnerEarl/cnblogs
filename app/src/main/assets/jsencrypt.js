var JSEncryptExports={};(function(ap){function bf(z,t,L){null!=z&&("number"==typeof z?this.fromNumber(z,t,L):null==t&&"string"!=typeof z?this.fromString(z,256):this.fromString(z,t))}function bm(){return new bf(null)}function a7(z,t,bZ,bY,bX,bW){for(;--bW>=0;){var L=t*this[z++]+bZ[bY]+bX;bX=Math.floor(L/67108864),bZ[bY++]=67108863&L}return bX}function a6(b3,b2,b1,b0,bZ,bY){for(var bX=32767&b2,bW=b2>>15;--bY>=0;){var L=32767&this[b3],z=this[b3++]>>15,t=bW*L+z*bX;L=bX*L+((32767&t)<<15)+b1[b0]+(1073741823&bZ),bZ=(L>>>30)+(t>>>15)+bW*z+(bZ>>>30),b1[b0++]=1073741823&L}return bZ}function a5(b3,b2,b1,b0,bZ,bY){for(var bX=16383&b2,bW=b2>>14;--bY>=0;){var L=16383&this[b3],z=this[b3++]>>14,t=bW*L+z*bX;L=bX*L+((16383&t)<<14)+b1[b0]+bZ,bZ=(L>>28)+(t>>14)+bW*z,b1[b0++]=268435455&L}return bZ}function Y(t){return a.charAt(t)}function aX(z,t){var L=g[z.charCodeAt(t)];return null==L?-1:L}function d(z){for(var t=this.t-1;t>=0;--t){z[t]=this[t]}z.t=this.t,z.s=this.s}function h(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function bi(z){var t=bm();return t.fromInt(z),t}function bI(z,t){var bZ;if(16==t){bZ=4}else{if(8==t){bZ=3}else{if(256==t){bZ=8}else{if(2==t){bZ=1}else{if(32==t){bZ=5}else{if(4!=t){return void this.fromRadix(z,t)}bZ=2}}}}}this.t=0,this.s=0;for(var bY=z.length,bX=!1,bW=0;--bY>=0;){var L=8==bZ?255&z[bY]:aX(z,bY);0>L?"-"==z.charAt(bY)&&(bX=!0):(bX=!1,0==bW?this[this.t++]=L:bW+bZ>this.DB?(this[this.t-1]|=(L&(1<<this.DB-bW)-1)<<bW,this[this.t++]=L>>this.DB-bW):this[this.t-1]|=L<<bW,bW+=bZ,bW>=this.DB&&(bW-=this.DB))}8==bZ&&0!=(128&z[0])&&(this.s=-1,bW>0&&(this[this.t-1]|=(1<<this.DB-bW)-1<<bW)),this.clamp(),bX&&bf.ZERO.subTo(this,this)}function bA(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;){--this.t}}function u(z){if(this.s<0){return"-"+this.negate().toString(z)}var t;if(16==z){t=4}else{if(8==z){t=3}else{if(2==z){t=1}else{if(32==z){t=5}else{if(4!=z){return this.toRadix(z)}t=2}}}}var b0,bZ=(1<<t)-1,bY=!1,bX="",bW=this.t,L=this.DB-bW*this.DB%t;if(bW-->0){for(L<this.DB&&(b0=this[bW]>>L)>0&&(bY=!0,bX=Y(b0));bW>=0;){t>L?(b0=(this[bW]&(1<<L)-1)<<t-L,b0|=this[--bW]>>(L+=this.DB-t)):(b0=this[bW]>>(L-=t)&bZ,0>=L&&(L+=this.DB,--bW)),b0>0&&(bY=!0),bY&&(bX+=Y(b0))}}return bY?bX:"0"}function bC(){var t=bm();return bf.ZERO.subTo(this,t),t}function bB(){return this.s<0?this.negate():this}function bN(z){var t=this.s-z.s;if(0!=t){return t}var L=this.t;if(t=L-z.t,0!=t){return this.s<0?-t:t}for(;--L>=0;){if(0!=(t=this[L]-z[L])){return t}}return 0}function q(z){var t,L=1;return 0!=(t=z>>>16)&&(z=t,L+=16),0!=(t=z>>8)&&(z=t,L+=8),0!=(t=z>>4)&&(z=t,L+=4),0!=(t=z>>2)&&(z=t,L+=2),0!=(t=z>>1)&&(z=t,L+=1),L}function bt(){return this.t<=0?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)}function bv(z,t){var L;for(L=this.t-1;L>=0;--L){t[L+z]=this[L]}for(L=z-1;L>=0;--L){t[L]=0}t.t=this.t+z,t.s=this.s}function a2(z,t){for(var L=z;L<this.t;++L){t[L-z]=this[L]}t.t=Math.max(this.t-z,0),t.s=this.s}function s(z,t){var b0,bZ=z%this.DB,bY=this.DB-bZ,bX=(1<<bY)-1,bW=Math.floor(z/this.DB),L=this.s<<bZ&this.DM;for(b0=this.t-1;b0>=0;--b0){t[b0+bW+1]=this[b0]>>bY|L,L=(this[b0]&bX)<<bZ}for(b0=bW-1;b0>=0;--b0){t[b0]=0}t[bW]=L,t.t=this.t+bW+1,t.s=this.s,t.clamp()}function bT(z,t){t.s=this.s;var bZ=Math.floor(z/this.DB);if(bZ>=this.t){return void (t.t=0)}var bY=z%this.DB,bX=this.DB-bY,bW=(1<<bY)-1;t[0]=this[bZ]>>bY;for(var L=bZ+1;L<this.t;++L){t[L-bZ-1]|=(this[L]&bW)<<bX,t[L-bZ]=this[L]>>bY}bY>0&&(t[this.t-bZ-1]|=(this.s&bW)<<bX),t.t=this.t-bZ,t.clamp()}function bs(z,t){for(var bX=0,bW=0,L=Math.min(z.t,this.t);L>bX;){bW+=this[bX]-z[bX],t[bX++]=bW&this.DM,bW>>=this.DB}if(z.t<this.t){for(bW-=z.s;bX<this.t;){bW+=this[bX],t[bX++]=bW&this.DM,bW>>=this.DB}bW+=this.s}else{for(bW+=this.s;bX<z.t;){bW-=z[bX],t[bX++]=bW&this.DM,bW>>=this.DB}bW-=z.s}t.s=0>bW?-1:0,-1>bW?t[bX++]=this.DV+bW:bW>0&&(t[bX++]=bW),t.t=bX,t.clamp()}function bJ(z,t){var bX=this.abs(),bW=z.abs(),L=bX.t;for(t.t=L+bW.t;--L>=0;){t[L]=0}for(L=0;L<bW.t;++L){t[L+bX.t]=bX.am(0,bW[L],t,L,0,bX.t)}t.s=0,t.clamp(),this.s!=z.s&&bf.ZERO.subTo(t,t)}function au(z){for(var t=this.abs(),bW=z.t=2*t.t;--bW>=0;){z[bW]=0}for(bW=0;bW<t.t-1;++bW){var L=t.am(bW,t[bW],z,2*bW,0,1);(z[bW+t.t]+=t.am(bW+1,2*t[bW],z,2*bW+1,L,t.t-bW-1))>=t.DV&&(z[bW+t.t]-=t.DV,z[bW+t.t+1]=1)}z.t>0&&(z[z.t-1]+=t.am(bW,t[bW],z,2*bW,0,1)),z.s=0,z.clamp()}function a9(cb,ca,b9){var b8=cb.abs();if(!(b8.t<=0)){var b7=this.abs();if(b7.t<b8.t){return null!=ca&&ca.fromInt(0),void (null!=b9&&this.copyTo(b9))}null==b9&&(b9=bm());var b6=bm(),b5=this.s,b4=cb.s,b3=this.DB-q(b8[b8.t-1]);b3>0?(b8.lShiftTo(b3,b6),b7.lShiftTo(b3,b9)):(b8.copyTo(b6),b7.copyTo(b9));var b2=b6.t,b1=b6[b2-1];if(0!=b1){var b0=b1*(1<<this.F1)+(b2>1?b6[b2-2]>>this.F2:0),bZ=this.FV/b0,bY=(1<<this.F1)/b0,bX=1<<this.F2,bW=b9.t,L=bW-b2,z=null==ca?bm():ca;for(b6.dlShiftTo(L,z),b9.compareTo(z)>=0&&(b9[b9.t++]=1,b9.subTo(z,b9)),bf.ONE.dlShiftTo(b2,z),z.subTo(b6,b6);b6.t<b2;){b6[b6.t++]=0}for(;--L>=0;){var t=b9[--bW]==b1?this.DM:Math.floor(b9[bW]*bZ+(b9[bW-1]+bX)*bY);if((b9[bW]+=b6.am(0,t,b9,L,0,b2))<t){for(b6.dlShiftTo(L,z),b9.subTo(z,b9);b9[bW]<--t;){b9.subTo(z,b9)}}}null!=ca&&(b9.drShiftTo(b2,ca),b5!=b4&&bf.ZERO.subTo(ca,ca)),b9.t=b2,b9.clamp(),b3>0&&b9.rShiftTo(b3,b9),0>b5&&bf.ZERO.subTo(b9,b9)}}}function bh(z){var t=bm();return this.abs().divRemTo(z,null,t),this.s<0&&t.compareTo(bf.ZERO)>0&&z.subTo(t,t),t}function aT(t){this.m=t}function aI(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function c(t){return t}function V(t){t.divRemTo(this.m,null,t)}function p(z,t,L){z.multiplyTo(t,L),this.reduce(L)}function aF(z,t){z.squareTo(t),this.reduce(t)}function ab(){if(this.t<1){return 0}var z=this[0];if(0==(1&z)){return 0}var t=3&z;return t=t*(2-(15&z)*t)&15,t=t*(2-(255&z)*t)&255,t=t*(2-((65535&z)*t&65535))&65535,t=t*(2-z*t%this.DV)%this.DV,t>0?this.DV-t:-t}function K(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function by(z){var t=bm();return z.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),z.s<0&&t.compareTo(bf.ZERO)>0&&this.m.subTo(t,t),t}function bl(z){var t=bm();return z.copyTo(t),this.reduce(t),t}function bV(z){for(;z.t<=this.mt2;){z[z.t++]=0}for(var t=0;t<this.m.t;++t){var bW=32767&z[t],L=bW*this.mpl+((bW*this.mph+(z[t]>>15)*this.mpl&this.um)<<15)&z.DM;for(bW=t+this.m.t,z[bW]+=this.m.am(0,L,z,t,0,this.m.t);z[bW]>=z.DV;){z[bW]-=z.DV,z[++bW]++}}z.clamp(),z.drShiftTo(this.m.t,z),z.compareTo(this.m)>=0&&z.subTo(this.m,z)}function ac(z,t){z.squareTo(t),this.reduce(t)}function bz(z,t,L){z.multiplyTo(t,L),this.reduce(L)}function ad(){return 0==(this.t>0?1&this[0]:this.s)}function am(z,t){if(z>4294967295||1>z){return bf.ONE}var bZ=bm(),bY=bm(),bX=t.convert(this),bW=q(z)-1;for(bX.copyTo(bZ);--bW>=0;){if(t.sqrTo(bZ,bY),(z&1<<bW)>0){t.mulTo(bY,bX,bZ)}else{var L=bZ;bZ=bY,bY=L}}return t.revert(bZ)}function aG(z,t){var L;return L=256>z||t.isEven()?new aT(t):new K(t),this.exp(z,L)}function f(){var t=bm();return this.copyTo(t),t}function b(){if(this.s<0){if(1==this.t){return this[0]-this.DV}if(0==this.t){return -1}}else{if(1==this.t){return this[0]}if(0==this.t){return 0}}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bF(){return 0==this.t?this.s:this[0]<<24>>24}function ag(){return 0==this.t?this.s:this[0]<<16>>16}function aU(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function aZ(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function I(z){if(null==z&&(z=10),0==this.signum()||2>z||z>36){return"0"}var t=this.chunkSize(z),bZ=Math.pow(z,t),bY=bi(bZ),bX=bm(),bW=bm(),L="";for(this.divRemTo(bY,bX,bW);bX.signum()>0;){L=(bZ+bW.intValue()).toString(z).substr(1)+L,bX.divRemTo(bY,bX,bW)}return bW.intValue().toString(z)+L}function av(b1,b0){this.fromInt(0),null==b0&&(b0=10);for(var bZ=this.chunkSize(b0),bY=Math.pow(b0,bZ),bX=!1,bW=0,L=0,z=0;z<b1.length;++z){var t=aX(b1,z);0>t?"-"==b1.charAt(z)&&0==this.signum()&&(bX=!0):(L=b0*L+t,++bW>=bZ&&(this.dMultiply(bY),this.dAddOffset(L,0),bW=0,L=0))}bW>0&&(this.dMultiply(Math.pow(b0,bW)),this.dAddOffset(L,0)),bX&&bf.ZERO.subTo(this,this)}function aP(z,t,bX){if("number"==typeof t){if(2>z){this.fromInt(1)}else{for(this.fromNumber(z,bX),this.testBit(z-1)||this.bitwiseTo(bf.ONE.shiftLeft(z-1),ak,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);){this.dAddOffset(2,0),this.bitLength()>z&&this.subTo(bf.ONE.shiftLeft(z-1),this)}}}else{var bW=new Array,L=7&z;bW.length=(z>>3)+1,t.nextBytes(bW),L>0?bW[0]&=(1<<L)-1:bW[0]=0,this.fromString(bW,256)}}function aK(){var z=this.t,t=new Array;t[0]=this.s;var bX,bW=this.DB-z*this.DB%8,L=0;if(z-->0){for(bW<this.DB&&(bX=this[z]>>bW)!=(this.s&this.DM)>>bW&&(t[L++]=bX|this.s<<this.DB-bW);z>=0;){8>bW?(bX=(this[z]&(1<<bW)-1)<<8-bW,bX|=this[--z]>>(bW+=this.DB-8)):(bX=this[z]>>(bW-=8)&255,0>=bW&&(bW+=this.DB,--z)),0!=(128&bX)&&(bX|=-256),0==L&&(128&this.s)!=(128&bX)&&++L,(L>0||bX!=this.s)&&(t[L++]=bX)}}return t}function bG(t){return 0==this.compareTo(t)}function W(t){return this.compareTo(t)<0?this:t}function bu(t){return this.compareTo(t)>0?this:t}function aJ(z,t,bY){var bX,bW,L=Math.min(z.t,this.t);for(bX=0;L>bX;++bX){bY[bX]=t(this[bX],z[bX])}if(z.t<this.t){for(bW=z.s&this.DM,bX=L;bX<this.t;++bX){bY[bX]=t(this[bX],bW)}bY.t=this.t}else{for(bW=this.s&this.DM,bX=L;bX<z.t;++bX){bY[bX]=t(bW,z[bX])}bY.t=z.t}bY.s=t(this.s,z.s),bY.clamp()}function o(z,t){return z&t}function bO(z){var t=bm();return this.bitwiseTo(z,o,t),t}function ak(z,t){return z|t}function aS(z){var t=bm();return this.bitwiseTo(z,ak,t),t}function aa(z,t){return z^t}function B(z){var t=bm();return this.bitwiseTo(z,aa,t),t}function i(z,t){return z&~t}function aD(z){var t=bm();return this.bitwiseTo(z,i,t),t}function T(){for(var z=bm(),t=0;t<this.t;++t){z[t]=this.DM&~this[t]}return z.t=this.t,z.s=~this.s,z}function aN(z){var t=bm();return 0>z?this.rShiftTo(-z,t):this.lShiftTo(z,t),t}function R(z){var t=bm();return 0>z?this.lShiftTo(-z,t):this.rShiftTo(z,t),t}function bc(z){if(0==z){return -1}var t=0;return 0==(65535&z)&&(z>>=16,t+=16),0==(255&z)&&(z>>=8,t+=8),0==(15&z)&&(z>>=4,t+=4),0==(3&z)&&(z>>=2,t+=2),0==(1&z)&&++t,t}function aq(){for(var t=0;t<this.t;++t){if(0!=this[t]){return t*this.DB+bc(this[t])}}return this.s<0?this.t*this.DB:-1}function bj(z){for(var t=0;0!=z;){z&=z-1,++t}return t}function ao(){for(var z=0,t=this.s&this.DM,L=0;L<this.t;++L){z+=bj(this[L]^t)}return z}function aL(z){var t=Math.floor(z/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<z%this.DB)}function U(z,t){var L=bf.ONE.shiftLeft(z);return this.bitwiseTo(L,t,L),L}function a1(t){return this.changeBit(t,ak)}function ah(t){return this.changeBit(t,i)}function aO(t){return this.changeBit(t,aa)}function S(z,t){for(var bX=0,bW=0,L=Math.min(z.t,this.t);L>bX;){bW+=this[bX]+z[bX],t[bX++]=bW&this.DM,bW>>=this.DB}if(z.t<this.t){for(bW+=z.s;bX<this.t;){bW+=this[bX],t[bX++]=bW&this.DM,bW>>=this.DB}bW+=this.s}else{for(bW+=this.s;bX<z.t;){bW+=z[bX],t[bX++]=bW&this.DM,bW>>=this.DB}bW+=z.s}t.s=0>bW?-1:0,bW>0?t[bX++]=bW:-1>bW&&(t[bX++]=this.DV+bW),t.t=bX,t.clamp()}function bg(z){var t=bm();return this.addTo(z,t),t}function aA(z){var t=bm();return this.subTo(z,t),t}function bH(z){var t=bm();return this.multiplyTo(z,t),t}function bU(){var t=bm();return this.squareTo(t),t}function bd(z){var t=bm();return this.divRemTo(z,t,null),t}function bP(z){var t=bm();return this.divRemTo(z,null,t),t}function bk(z){var t=bm(),L=bm();return this.divRemTo(z,t,L),new Array(t,L)}function e(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function aR(z,t){if(0!=z){for(;this.t<=t;){this[this.t++]=0}for(this[t]+=z;this[t]>=this.DV;){this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}}function Z(){}function bw(t){return t}function bK(z,t,L){z.multiplyTo(t,L)}function ai(z,t){z.squareTo(t)}function Q(t){return this.exp(t,new Z)}function aQ(z,t,bX){var bW=Math.min(this.t+z.t,t);for(bX.s=0,bX.t=bW;bW>0;){bX[--bW]=0}var L;for(L=bX.t-this.t;L>bW;++bW){bX[bW+this.t]=this.am(0,z[bW],bX,bW,0,this.t)}for(L=Math.min(z.t,t);L>bW;++bW){this.am(0,z[bW],bX,bW,0,t-bW)}bX.clamp()}function a0(z,t,bW){--t;var L=bW.t=this.t+z.t-t;for(bW.s=0;--L>=0;){bW[L]=0}for(L=Math.max(t-this.t,0);L<z.t;++L){bW[this.t+L-t]=this.am(t-L,z[L],bW,0,0,this.t+L-t)}bW.clamp(),bW.drShiftTo(1,bW)}function bR(t){this.r2=bm(),this.q3=bm(),bf.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function H(z){if(z.s<0||z.t>2*this.m.t){return z.mod(this.m)}if(z.compareTo(this.m)<0){return z}var t=bm();return z.copyTo(t),this.reduce(t),t}function bM(t){return t}function D(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;){t.dAddOffset(1,this.m.t+1)}for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;){t.subTo(this.m,t)}}function aM(z,t){z.squareTo(t),this.reduce(t)}function x(z,t,L){z.multiplyTo(t,L),this.reduce(L)}function N(b8,b7){var b6,b5,b4=b8.bitLength(),b3=bi(1);if(0>=b4){return b3}b6=18>b4?1:48>b4?3:144>b4?4:768>b4?5:6,b5=8>b4?new aT(b7):b7.isEven()?new bR(b7):new K(b7);var b2=new Array,b1=3,b0=b6-1,bZ=(1<<b6)-1;if(b2[1]=b5.convert(this),b6>1){var bY=bm();for(b5.sqrTo(b2[1],bY);bZ>=b1;){b2[b1]=bm(),b5.mulTo(bY,b2[b1-2],b2[b1]),b1+=2}}var bX,bW,L=b8.t-1,z=!0,t=bm();for(b4=q(b8[L])-1;L>=0;){for(b4>=b0?bX=b8[L]>>b4-b0&bZ:(bX=(b8[L]&(1<<b4+1)-1)<<b0-b4,L>0&&(bX|=b8[L-1]>>this.DB+b4-b0)),b1=b6;0==(1&bX);){bX>>=1,--b1}if((b4-=b1)<0&&(b4+=this.DB,--L),z){b2[bX].copyTo(b3),z=!1}else{for(;b1>1;){b5.sqrTo(b3,t),b5.sqrTo(t,b3),b1-=2}b1>0?b5.sqrTo(b3,t):(bW=b3,b3=t,t=bW),b5.mulTo(t,b2[bX],b3)}for(;L>=0&&0==(b8[L]&1<<b4);){b5.sqrTo(b3,t),bW=b3,b3=t,t=bW,--b4<0&&(b4=this.DB-1,--L)}}return b5.revert(b3)}function aB(z){var t=this.s<0?this.negate():this.clone(),bY=z.s<0?z.negate():z.clone();if(t.compareTo(bY)<0){var bX=t;t=bY,bY=bX}var bW=t.getLowestSetBit(),L=bY.getLowestSetBit();if(0>L){return t}for(L>bW&&(L=bW),L>0&&(t.rShiftTo(L,t),bY.rShiftTo(L,bY));t.signum()>0;){(bW=t.getLowestSetBit())>0&&t.rShiftTo(bW,t),(bW=bY.getLowestSetBit())>0&&bY.rShiftTo(bW,bY),t.compareTo(bY)>=0?(t.subTo(bY,t),t.rShiftTo(1,t)):(bY.subTo(t,bY),bY.rShiftTo(1,bY))}return L>0&&bY.lShiftTo(L,bY),bY}function aj(z){if(0>=z){return 0}var t=this.DV%z,bW=this.s<0?z-1:0;if(this.t>0){if(0==t){bW=this[0]%z}else{for(var L=this.t-1;L>=0;--L){bW=(t*bW+this[L])%z}}}return bW}function bS(z){var t=z.isEven();if(this.isEven()&&t||0==z.signum()){return bf.ZERO}for(var b0=z.clone(),bZ=this.clone(),bY=bi(1),bX=bi(0),bW=bi(0),L=bi(1);0!=b0.signum();){for(;b0.isEven();){b0.rShiftTo(1,b0),t?(bY.isEven()&&bX.isEven()||(bY.addTo(this,bY),bX.subTo(z,bX)),bY.rShiftTo(1,bY)):bX.isEven()||bX.subTo(z,bX),bX.rShiftTo(1,bX)}for(;bZ.isEven();){bZ.rShiftTo(1,bZ),t?(bW.isEven()&&L.isEven()||(bW.addTo(this,bW),L.subTo(z,L)),bW.rShiftTo(1,bW)):L.isEven()||L.subTo(z,L),L.rShiftTo(1,L)}b0.compareTo(bZ)>=0?(b0.subTo(bZ,b0),t&&bY.subTo(bW,bY),bX.subTo(L,bX)):(bZ.subTo(b0,bZ),t&&bW.subTo(bY,bW),L.subTo(bX,L))}return 0!=bZ.compareTo(bf.ONE)?bf.ZERO:L.compareTo(z)>=0?L.subtract(z):L.signum()<0?(L.addTo(z,L),L.signum()<0?L.add(z):L):L}function bL(z){var t,bX=this.abs();if(1==bX.t&&bX[0]<=az[az.length-1]){for(t=0;t<az.length;++t){if(bX[0]==az[t]){return !0}}return !1}if(bX.isEven()){return !1}for(t=1;t<az.length;){for(var bW=az[t],L=t+1;L<az.length&&k>bW;){bW*=az[L++]}for(bW=bX.modInt(bW);L>t;){if(bW%az[t++]==0){return !1}}}return bX.millerRabin(z)}function aE(z){var t=this.subtract(bf.ONE),b0=t.getLowestSetBit();if(0>=b0){return !1}var bZ=t.shiftRight(b0);z=z+1>>1,z>az.length&&(z=az.length);for(var bY=bm(),bX=0;z>bX;++bX){bY.fromInt(az[Math.floor(Math.random()*az.length)]);var bW=bY.modPow(bZ,this);if(0!=bW.compareTo(bf.ONE)&&0!=bW.compareTo(t)){for(var L=1;L++<b0&&0!=bW.compareTo(t);){if(bW=bW.modPowInt(2,this),0==bW.compareTo(bf.ONE)){return !1}}if(0!=bW.compareTo(t)){return !1}}}return !0}function bp(){this.i=0,this.j=0,this.S=new Array}function af(z){var t,bW,L;for(t=0;256>t;++t){this.S[t]=t}for(bW=0,t=0;256>t;++t){bW=bW+this.S[t]+z[t%z.length]&255,L=this.S[t],this.S[t]=this.S[bW],this.S[bW]=L}this.i=0,this.j=0}function be(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function P(){return new bp}function bb(){if(null==j){for(j=P();y>C;){var t=Math.floor(65536*Math.random());l[C++]=255&t}for(j.init(l),C=0;C<l.length;++C){l[C]=0}C=0}return j.next()}function aY(z){var t;for(t=0;t<z.length;++t){z[t]=bb()}}function G(){}function w(z,t){return new bf(z,t)}function m(z,t){for(var bW="",L=0;L+t<z.length;){bW+=z.substring(L,L+t)+"\n",L+=t}return bW+z.substring(L,z.length)}function br(t){return 16>t?"0"+t.toString(16):t.toString(16)}function bD(z,t){if(t<z.length+11){return console.error("Message too long for RSA"),null}for(var bZ=new Array,bY=z.length-1;bY>=0&&t>0;){var bX=z.charCodeAt(bY--);128>bX?bZ[--t]=bX:bX>127&&2048>bX?(bZ[--t]=63&bX|128,bZ[--t]=bX>>6|192):(bZ[--t]=63&bX|128,bZ[--t]=bX>>6&63|128,bZ[--t]=bX>>12|224)}bZ[--t]=0;for(var bW=new G,L=new Array;t>2;){for(L[0]=0;0==L[0];){bW.nextBytes(L)}bZ[--t]=L[0]}return bZ[--t]=2,bZ[--t]=0,new bf(bZ)}function A(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function an(z,t){null!=z&&null!=t&&z.length>0&&t.length>0?(this.n=w(z,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")}function bq(t){return t.modPowInt(this.e,this.n)}function al(z){var t=bD(z,this.n.bitLength()+7>>3);if(null==t){return null}var bW=this.doPublic(t);if(null==bW){return null}var L=bW.toString(16);return 0==(1&L.length)?L:"0"+L}function bo(z,t){for(var bY=z.toByteArray(),bX=0;bX<bY.length&&0==bY[bX];){++bX}if(bY.length-bX!=t-1||2!=bY[bX]){return null}for(++bX;0!=bY[bX];){if(++bX>=bY.length){return null}}for(var bW="";++bX<bY.length;){var L=255&bY[bX];128>L?bW+=String.fromCharCode(L):L>191&&224>L?(bW+=String.fromCharCode((31&L)<<6|63&bY[bX+1]),++bX):(bW+=String.fromCharCode((15&L)<<12|(63&bY[bX+1])<<6|63&bY[bX+2]),bX+=2)}return bW}function aC(z,t,L){null!=z&&null!=t&&z.length>0&&t.length>0?(this.n=w(z,16),this.e=parseInt(t,16),this.d=w(L,16)):console.error("Invalid RSA private key")}function O(z,t,b0,bZ,bY,bX,bW,L){null!=z&&null!=t&&z.length>0&&t.length>0?(this.n=w(z,16),this.e=parseInt(t,16),this.d=w(b0,16),this.p=w(bZ,16),this.q=w(bY,16),this.dmp1=w(bX,16),this.dmq1=w(bW,16),this.coeff=w(L,16)):console.error("Invalid RSA private key")}function ax(b1,b0){var bZ=new G,bY=b1>>1;this.e=parseInt(b0,16);for(var bX=new bf(b0,16);;){for(;this.p=new bf(b1-bY,1,bZ),0!=this.p.subtract(bf.ONE).gcd(bX).compareTo(bf.ONE)||!this.p.isProbablePrime(10);){}for(;this.q=new bf(bY,1,bZ),0!=this.q.subtract(bf.ONE).gcd(bX).compareTo(bf.ONE)||!this.q.isProbablePrime(10);){}if(this.p.compareTo(this.q)<=0){var bW=this.p;this.p=this.q,this.q=bW}var L=this.p.subtract(bf.ONE),z=this.q.subtract(bf.ONE),t=L.multiply(z);if(0==t.gcd(bX).compareTo(bf.ONE)){this.n=this.p.multiply(this.q),this.d=bX.modInverse(t),this.dmp1=this.d.mod(L),this.dmq1=this.d.mod(z),this.coeff=this.q.modInverse(this.p);break}}}function ay(z){if(null==this.p||null==this.q){return z.modPow(this.d,this.n)}for(var t=z.mod(this.p).modPow(this.dmp1,this.p),L=z.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(L)<0;){t=t.add(this.p)}return t.subtract(L).multiply(this.coeff).mod(this.p).multiply(this.q).add(L)}function r(z){var t=w(z,16),L=this.doPrivate(t);return null==L?null:bo(L,this.n.bitLength()+7>>3)}function ae(z){var t,bW,L="";for(t=0;t+3<=z.length;t+=3){bW=parseInt(z.substring(t,t+3),16),L+=a4.charAt(bW>>6)+a4.charAt(63&bW)}for(t+1==z.length?(bW=parseInt(z.substring(t,t+1),16),L+=a4.charAt(bW<<2)):t+2==z.length&&(bW=parseInt(z.substring(t,t+2),16),L+=a4.charAt(bW>>2)+a4.charAt((3&bW)<<4));(3&L.length)>0;){L+=J}return L}function aW(z){var t,bX,bW="",L=0;for(t=0;t<z.length&&z.charAt(t)!=J;++t){v=a4.indexOf(z.charAt(t)),v<0||(0==L?(bW+=Y(v>>2),bX=3&v,L=1):1==L?(bW+=Y(bX<<2|v>>4),bX=15&v,L=2):2==L?(bW+=Y(bX),bW+=Y(v>>2),bX=3&v,L=3):(bW+=Y(bX<<2|v>>4),bW+=Y(15&v),L=0))}return 1==L&&(bW+=Y(bX<<2)),bW}function M(z){var t,bW=aW(z),L=new Array;for(t=0;2*t<bW.length;++t){L[t]=parseInt(bW.substring(2*t,2*t+2),16)}return L}var bE,n=244837814094590,aV=15715070==(16777215&n);aV&&"Microsoft Internet Explorer"==navigator.appName?(bf.prototype.am=a6,bE=30):aV&&"Netscape"!=navigator.appName?(bf.prototype.am=a7,bE=26):(bf.prototype.am=a5,bE=28),bf.prototype.DB=bE,bf.prototype.DM=(1<<bE)-1,bf.prototype.DV=1<<bE;var bQ=52;bf.prototype.FV=Math.pow(2,bQ),bf.prototype.F1=bQ-bE,bf.prototype.F2=2*bE-bQ;var a="0123456789abcdefghijklmnopqrstuvwxyz",g=new Array,aH,E;for(aH="0".charCodeAt(0),E=0;9>=E;++E){g[aH++]=E}for(aH="a".charCodeAt(0),E=10;36>E;++E){g[aH++]=E}for(aH="A".charCodeAt(0),E=10;36>E;++E){g[aH++]=E}aT.prototype.convert=aI,aT.prototype.revert=c,aT.prototype.reduce=V,aT.prototype.mulTo=p,aT.prototype.sqrTo=aF,K.prototype.convert=by,K.prototype.revert=bl,K.prototype.reduce=bV,K.prototype.mulTo=bz,K.prototype.sqrTo=ac,bf.prototype.copyTo=d,bf.prototype.fromInt=h,bf.prototype.fromString=bI,bf.prototype.clamp=bA,bf.prototype.dlShiftTo=bv,bf.prototype.drShiftTo=a2,bf.prototype.lShiftTo=s,bf.prototype.rShiftTo=bT,bf.prototype.subTo=bs,bf.prototype.multiplyTo=bJ,bf.prototype.squareTo=au,bf.prototype.divRemTo=a9,bf.prototype.invDigit=ab,bf.prototype.isEven=ad,bf.prototype.exp=am,bf.prototype.toString=u,bf.prototype.negate=bC,bf.prototype.abs=bB,bf.prototype.compareTo=bN,bf.prototype.bitLength=bt,bf.prototype.mod=bh,bf.prototype.modPowInt=aG,bf.ZERO=bi(0),bf.ONE=bi(1),Z.prototype.convert=bw,Z.prototype.revert=bw,Z.prototype.mulTo=bK,Z.prototype.sqrTo=ai,bR.prototype.convert=H,bR.prototype.revert=bM,bR.prototype.reduce=D,bR.prototype.mulTo=x,bR.prototype.sqrTo=aM;var az=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],k=(1<<26)/az[az.length-1];bf.prototype.chunkSize=aU,bf.prototype.toRadix=I,bf.prototype.fromRadix=av,bf.prototype.fromNumber=aP,bf.prototype.bitwiseTo=aJ,bf.prototype.changeBit=U,bf.prototype.addTo=S,bf.prototype.dMultiply=e,bf.prototype.dAddOffset=aR,bf.prototype.multiplyLowerTo=aQ,bf.prototype.multiplyUpperTo=a0,bf.prototype.modInt=aj,bf.prototype.millerRabin=aE,bf.prototype.clone=f,bf.prototype.intValue=b,bf.prototype.byteValue=bF,bf.prototype.shortValue=ag,bf.prototype.signum=aZ,bf.prototype.toByteArray=aK,bf.prototype.equals=bG,bf.prototype.min=W,bf.prototype.max=bu,bf.prototype.and=bO,bf.prototype.or=aS,bf.prototype.xor=B,bf.prototype.andNot=aD,bf.prototype.not=T,bf.prototype.shiftLeft=aN,bf.prototype.shiftRight=R,bf.prototype.getLowestSetBit=aq,bf.prototype.bitCount=ao,bf.prototype.testBit=aL,bf.prototype.setBit=a1,bf.prototype.clearBit=ah,bf.prototype.flipBit=aO,bf.prototype.add=bg,bf.prototype.subtract=aA,bf.prototype.multiply=bH,bf.prototype.divide=bd,bf.prototype.remainder=bP,bf.prototype.divideAndRemainder=bk,bf.prototype.modPow=N,bf.prototype.modInverse=bS,bf.prototype.pow=Q,bf.prototype.gcd=aB,bf.prototype.isProbablePrime=bL,bf.prototype.square=bU,bp.prototype.init=af,bp.prototype.next=be;var y=256,j,l,C;if(null==l){l=new Array,C=0;var ba;if(window.crypto&&window.crypto.getRandomValues){var a8=new Uint32Array(256);for(window.crypto.getRandomValues(a8),ba=0;ba<a8.length;++ba){l[C++]=255&a8[ba]}}var F=function(z){if(this.count=this.count||0,this.count>=256||C>=y){return void (window.removeEventListener?window.removeEventListener("mousemove",F):window.detachEvent&&window.detachEvent("onmousemove",F))}this.count+=1;var t=z.x+z.y;l[C++]=255&t};window.addEventListener?window.addEventListener("mousemove",F):window.attachEvent&&window.attachEvent("onmousemove",F)}G.prototype.nextBytes=aY,A.prototype.doPublic=bq,A.prototype.setPublic=an,A.prototype.encrypt=al,A.prototype.doPrivate=ay,A.prototype.setPrivate=aC,A.prototype.setPrivateEx=O,A.prototype.generate=ax,A.prototype.decrypt=r,function(){var z=function(bX,bW,b3){var b2=new G,b1=bX>>1;this.e=parseInt(bW,16);var b0=new bf(bW,16),bZ=this,bY=function(){var b4=function(){if(bZ.p.compareTo(bZ.q)<=0){var b8=bZ.p;bZ.p=bZ.q,bZ.q=b8}var b7=bZ.p.subtract(bf.ONE),ca=bZ.q.subtract(bf.ONE),b9=b7.multiply(ca);0==b9.gcd(b0).compareTo(bf.ONE)?(bZ.n=bZ.p.multiply(bZ.q),bZ.d=b0.modInverse(b9),bZ.dmp1=bZ.d.mod(b7),bZ.dmq1=bZ.d.mod(ca),bZ.coeff=bZ.q.modInverse(bZ.p),setTimeout(function(){b3()},0)):setTimeout(bY,0)},b6=function(){bZ.q=bm(),bZ.q.fromNumberAsync(b1,1,b2,function(){bZ.q.subtract(bf.ONE).gcda(b0,function(b7){0==b7.compareTo(bf.ONE)&&bZ.q.isProbablePrime(10)?setTimeout(b4,0):setTimeout(b6,0)})})},b5=function(){bZ.p=bm(),bZ.p.fromNumberAsync(bX-b1,1,b2,function(){bZ.p.subtract(bf.ONE).gcda(b0,function(b7){0==b7.compareTo(bf.ONE)&&bZ.p.isProbablePrime(10)?setTimeout(b6,0):setTimeout(b5,0)})})};setTimeout(b5,0)};setTimeout(bY,0)};A.prototype.generateAsync=z;var t=function(bX,bW){var b3=this.s<0?this.negate():this.clone(),b2=bX.s<0?bX.negate():bX.clone();if(b3.compareTo(b2)<0){var b1=b3;b3=b2,b2=b1}var b0=b3.getLowestSetBit(),bZ=b2.getLowestSetBit();if(0>bZ){return void bW(b3)}bZ>b0&&(bZ=b0),bZ>0&&(b3.rShiftTo(bZ,b3),b2.rShiftTo(bZ,b2));var bY=function(){(b0=b3.getLowestSetBit())>0&&b3.rShiftTo(b0,b3),(b0=b2.getLowestSetBit())>0&&b2.rShiftTo(b0,b2),b3.compareTo(b2)>=0?(b3.subTo(b2,b3),b3.rShiftTo(1,b3)):(b2.subTo(b3,b2),b2.rShiftTo(1,b2)),b3.signum()>0?setTimeout(bY,0):(bZ>0&&b2.lShiftTo(bZ,b2),setTimeout(function(){bW(b2)},0))};setTimeout(bY,10)};bf.prototype.gcda=t;var L=function(bX,bW,b3,b2){if("number"==typeof bW){if(2>bX){this.fromInt(1)}else{this.fromNumber(bX,b3),this.testBit(bX-1)||this.bitwiseTo(bf.ONE.shiftLeft(bX-1),ak,this),this.isEven()&&this.dAddOffset(1,0);var b1=this,b0=function(){b1.dAddOffset(2,0),b1.bitLength()>bX&&b1.subTo(bf.ONE.shiftLeft(bX-1),b1),b1.isProbablePrime(bW)?setTimeout(function(){b2()},0):setTimeout(b0,0)};setTimeout(b0,0)}}else{var bZ=new Array,bY=7&bX;bZ.length=(bX>>3)+1,bW.nextBytes(bZ),bY>0?bZ[0]&=(1<<bY)-1:bZ[0]=0,this.fromString(bZ,256)}};bf.prototype.fromNumberAsync=L}();var a4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J="=",at=at||{};at.env=at.env||{};var bn=at,aw=Object.prototype,ar="[object Function]",X=["toString","valueOf"];at.env.parseUA=function(z){var t,b0=function(b2){var b1=0;return parseFloat(b2.replace(/\./g,function(){return 1==b1++?"":"."}))},bZ=navigator,bY={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:bZ&&bZ.cajaVersion,secure:!1,os:null},bX=z||navigator&&navigator.userAgent,bW=window&&window.location,L=bW&&bW.href;return bY.secure=L&&0===L.toLowerCase().indexOf("https"),bX&&(/windows|win32/i.test(bX)?bY.os="windows":/macintosh/i.test(bX)?bY.os="macintosh":/rhino/i.test(bX)&&(bY.os="rhino"),/KHTML/.test(bX)&&(bY.webkit=1),t=bX.match(/AppleWebKit\/([^\s]*)/),t&&t[1]&&(bY.webkit=b0(t[1]),/ Mobile\//.test(bX)?(bY.mobile="Apple",t=bX.match(/OS ([^\s]*)/),t&&t[1]&&(t=b0(t[1].replace("_","."))),bY.ios=t,bY.ipad=bY.ipod=bY.iphone=0,t=bX.match(/iPad|iPod|iPhone/),t&&t[0]&&(bY[t[0].toLowerCase()]=bY.ios)):(t=bX.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),t&&(bY.mobile=t[0]),/webOS/.test(bX)&&(bY.mobile="WebOS",t=bX.match(/webOS\/([^\s]*);/),t&&t[1]&&(bY.webos=b0(t[1]))),/ Android/.test(bX)&&(bY.mobile="Android",t=bX.match(/Android ([^\s]*);/),t&&t[1]&&(bY.android=b0(t[1])))),t=bX.match(/Chrome\/([^\s]*)/),t&&t[1]?bY.chrome=b0(t[1]):(t=bX.match(/AdobeAIR\/([^\s]*)/),t&&(bY.air=t[0]))),bY.webkit||(t=bX.match(/Opera[\s\/]([^\s]*)/),t&&t[1]?(bY.opera=b0(t[1]),t=bX.match(/Version\/([^\s]*)/),t&&t[1]&&(bY.opera=b0(t[1])),t=bX.match(/Opera Mini[^;]*/),t&&(bY.mobile=t[0])):(t=bX.match(/MSIE\s([^;]*)/),t&&t[1]?bY.ie=b0(t[1]):(t=bX.match(/Gecko\/([^\s]*)/),t&&(bY.gecko=1,t=bX.match(/rv:([^\s\)]*)/),t&&t[1]&&(bY.gecko=b0(t[1]))))))),bY},at.env.ua=at.env.parseUA(),at.isFunction=function(t){return"function"==typeof t||aw.toString.apply(t)===ar},at._IEEnumFix=at.env.ua.ie?function(z,t){var bX,bW,L;for(bX=0;bX<X.length;bX+=1){bW=X[bX],L=t[bW],bn.isFunction(L)&&L!=aw[bW]&&(z[bW]=L)}}:function(){},at.extend=function(z,t,bX){if(!t||!z){throw new Error("extend failed, please check that all dependencies are included.")}var bW,L=function(){};if(L.prototype=t.prototype,z.prototype=new L,z.prototype.constructor=z,z.superclass=t.prototype,t.prototype.constructor==aw.constructor&&(t.prototype.constructor=t),bX){for(bW in bX){bn.hasOwnProperty(bX,bW)&&(z.prototype[bW]=bX[bW])}bn._IEEnumFix(z.prototype,bX)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(z){var t=z.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(z){var t=z.toString(16);if("-"!=t.substr(0,1)){t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t)}else{var b0=t.substr(1),bZ=b0.length;bZ%2==1?bZ+=1:t.match(/^[0-7]/)||(bZ+=2);for(var bY="",bX=0;bZ>bX;bX++){bY+="f"}var bW=new bf(bY,16),L=bW.xor(z).add(bf.ONE);t=L.toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(z,t){var bX=CryptoJS.enc.Hex.parse(z),bW=CryptoJS.enc.Base64.stringify(bX),L=bW.replace(/(.{64})/g,"$1\r\n");return L=L.replace(/\r\n$/,""),"-----BEGIN "+t+"-----\r\n"+L+"\r\n-----END "+t+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+t.length+",v="+this.hV}var z=this.hV.length/2,bX=z.toString(16);if(bX.length%2==1&&(bX="0"+bX),128>z){return bX}var bW=bX.length/2;if(bW>15){throw"ASN.1 length too long to represent by 8x: n = "+z.toString(16)}var L=128+bW;return L.toString(16)+bX},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(z){this.hTLV=null,this.isModified=!0,this.s=z,this.hV=stohex(this.s)},this.setStringHex=function(z){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=z},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex&&this.setStringHex(t.hex))},at.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(z){utc=z.getTime()+60000*z.getTimezoneOffset();var t=new Date(utc);return t},this.formatDate=function(b2,b1){var b0=this.zeroPadding,bZ=this.localDateToUTC(b2),bY=String(bZ.getFullYear());"utc"==b1&&(bY=bY.substr(2,2));var bX=b0(String(bZ.getMonth()+1),2),bW=b0(String(bZ.getDate()),2),L=b0(String(bZ.getHours()),2),z=b0(String(bZ.getMinutes()),2),t=b0(String(bZ.getSeconds()),2);return bY+bX+bW+L+z+t+"Z"},this.zeroPadding=function(z,t){return z.length>=t?z:new Array(t-z.length+1).join("0")+z},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(z,t,bZ,bY,bX,bW){var L=new Date(Date.UTC(z,t-1,bZ,bY,bX,bW,0));this.setByDate(L)},this.getFreshValueHex=function(){return this.hV}},at.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(z){this.hTLV=null,this.isModified=!0,this.asn1Array=z},this.appendASN1Object=function(z){this.hTLV=null,this.isModified=!0,this.asn1Array.push(z)},this.asn1Array=new Array,"undefined"!=typeof t&&"undefined"!=typeof t.array&&(this.asn1Array=t.array)},at.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},at.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(z){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(z)},this.setByInteger=function(L){var z=new bf(String(L),10);this.setByBigInteger(z)},this.setValueHex=function(z){this.hV=z},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.bigint?this.setByBigInteger(t.bigint):"undefined"!=typeof t["int"]?this.setByInteger(t["int"]):"undefined"!=typeof t.hex&&this.setValueHex(t.hex))},at.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(z){this.hTLV=null,this.isModified=!0,this.hV=z},this.setUnusedBitsAndHexValue=function(L,z){if(0>L||L>7){throw"unused bits shall be from 0 to 7: u = "+L}var bW="0"+L;this.hTLV=null,this.isModified=!0,this.hV=bW+z},this.setByBinaryString=function(L){L=L.replace(/0+$/,"");var z=8-L.length%8;8==z&&(z=0);for(var bZ=0;z>=bZ;bZ++){L+="0"}for(var bY="",bZ=0;bZ<L.length-1;bZ+=8){var bX=L.substr(bZ,8),bW=parseInt(bX,2).toString(16);1==bW.length&&(bW="0"+bW),bY+=bW}this.hTLV=null,this.isModified=!0,this.hV="0"+z+bY},this.setByBooleanArray=function(L){for(var z="",bW=0;bW<L.length;bW++){z+=1==L[bW]?"1":"0"}this.setByBinaryString(z)},this.newFalseArray=function(L){for(var z=new Array(L),bW=0;L>bW;bW++){z[bW]=!1}return z},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.hex?this.setHexValueIncludingUnusedBits(t.hex):"undefined"!=typeof t.bin?this.setByBinaryString(t.bin):"undefined"!=typeof t.array&&this.setByBooleanArray(t.array))},at.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},at.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},at.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(z){var t=function(bX){var bW=bX.toString(16);return 1==bW.length&&(bW="0"+bW),bW},L=function(bW){var b3="",b2=new bf(bW,10),b1=b2.toString(2),b0=7-b1.length%7;7==b0&&(b0=0);for(var bZ="",bY=0;b0>bY;bY++){bZ+="0"}b1=bZ+b1;for(var bY=0;bY<b1.length-1;bY+=7){var bX=b1.substr(bY,7);bY!=b1.length-7&&(bX="1"+bX),b3+=t(parseInt(bX,2))}return b3};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(bW){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=bW},this.setValueOidString=function(bW){if(!bW.match(/^[0-9.]+$/)){throw"malformed oid string: "+bW}var b0="",bZ=bW.split("."),bY=40*parseInt(bZ[0])+parseInt(bZ[1]);b0+=t(bY),bZ.splice(0,2);for(var bX=0;bX<bZ.length;bX++){b0+=L(bZ[bX])}this.hTLV=null,this.isModified=!0,this.s=null,this.hV=b0},this.setValueName=function(bX){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[bX]){throw"DERObjectIdentifier oidName undefined: "+bX}var bW=KJUR.asn1.x509.OID.name2oidList[bX];this.setValueOidString(bW)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof z&&("undefined"!=typeof z.oid?this.setValueOidString(z.oid):"undefined"!=typeof z.hex?this.setValueHex(z.hex):"undefined"!=typeof z.name&&this.setValueName(z.name))},at.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},at.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},at.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},at.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},at.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},at.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(z){this.hTLV=null,this.isModified=!0,this.date=z,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},at.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(z){this.hTLV=null,this.isModified=!0,this.date=z,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},at.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var L="",z=0;z<this.asn1Array.length;z++){var bW=this.asn1Array[z];L+=bW.getEncodedHex()}return this.hV=L,this.hV}},at.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var L=new Array,z=0;z<this.asn1Array.length;z++){var bW=this.asn1Array[z];L.push(bW.getEncodedHex())}return L.sort(),this.hV=L.join(""),this.hV}},at.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(L,z,bW){this.hT=z,this.isExplicit=L,this.asn1Object=bW,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=bW.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,z),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.tag&&(this.hT=t.tag),"undefined"!=typeof t.explicit&&(this.isExplicit=t.explicit),"undefined"!=typeof t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},at.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(z){var t,L={};L.decode=function(b3){var b2;if(t===z){var b1="0123456789ABCDEF",b0=" \f\n\r	 \u2028\u2029";for(t=[],b2=0;16>b2;++b2){t[b1.charAt(b2)]=b2}for(b1=b1.toLowerCase(),b2=10;16>b2;++b2){t[b1.charAt(b2)]=b2}for(b2=0;b2<b0.length;++b2){t[b0.charAt(b2)]=-1}}var bZ=[],bY=0,bX=0;for(b2=0;b2<b3.length;++b2){var bW=b3.charAt(b2);if("="==bW){break}if(bW=t[bW],-1!=bW){if(bW===z){throw"Illegal character at offset "+b2}bY|=bW,++bX>=2?(bZ[bZ.length]=bY,bY=0,bX=0):bY<<=4}}if(bX){throw"Hex encoding incomplete: 4 bits missing"}return bZ},window.Hex=L}(),function(z){var t,L={};L.decode=function(b3){var b2;if(t===z){var b1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b0="= \f\n\r	 \u2028\u2029";for(t=[],b2=0;64>b2;++b2){t[b1.charAt(b2)]=b2}for(b2=0;b2<b0.length;++b2){t[b0.charAt(b2)]=-1}}var bZ=[],bY=0,bX=0;for(b2=0;b2<b3.length;++b2){var bW=b3.charAt(b2);if("="==bW){break}if(bW=t[bW],-1!=bW){if(bW===z){throw"Illegal character at offset "+b2}bY|=bW,++bX>=4?(bZ[bZ.length]=bY>>16,bZ[bZ.length]=bY>>8&255,bZ[bZ.length]=255&bY,bY=0,bX=0):bY<<=6}}switch(bX){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:bZ[bZ.length]=bY>>10;break;case 3:bZ[bZ.length]=bY>>16,bZ[bZ.length]=bY>>8&255}return bZ},L.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,L.unarmor=function(bX){var bW=L.re.exec(bX);if(bW){if(bW[1]){bX=bW[1]}else{if(!bW[2]){throw"RegExp out of sync"}bX=bW[2]}}return L.decode(bX)},window.Base64=L}(),function(z){function t(bZ,b0){bZ instanceof t?(this.enc=bZ.enc,this.pos=bZ.pos):(this.enc=bZ,this.pos=b0)}function bY(b0,bZ,b3,b2,b1){this.stream=b0,this.header=bZ,this.length=b3,this.tag=b2,this.sub=b1}var bX=100,bW="…",L={tag:function(b0,bZ){var b1=document.createElement(b0);return b1.className=bZ,b1},text:function(bZ){return document.createTextNode(bZ)}};t.prototype.get=function(bZ){if(bZ===z&&(bZ=this.pos++),bZ>=this.enc.length){throw"Requesting byte offset "+bZ+" on a stream of length "+this.enc.length}return this.enc[bZ]},t.prototype.hexDigits="0123456789ABCDEF",t.prototype.hexByte=function(bZ){return this.hexDigits.charAt(bZ>>4&15)+this.hexDigits.charAt(15&bZ)},t.prototype.hexDump=function(b0,bZ,b3){for(var b2="",b1=b0;bZ>b1;++b1){if(b2+=this.hexByte(this.get(b1)),b3!==!0){switch(15&b1){case 7:b2+="  ";break;case 15:b2+="\n";break;default:b2+=" "}}}return b2},t.prototype.parseStringISO=function(b0,bZ){for(var b2="",b1=b0;bZ>b1;++b1){b2+=String.fromCharCode(this.get(b1))}return b2},t.prototype.parseStringUTF=function(b0,bZ){for(var b3="",b2=b0;bZ>b2;){var b1=this.get(b2++);b3+=String.fromCharCode(128>b1?b1:b1>191&&224>b1?(31&b1)<<6|63&this.get(b2++):(15&b1)<<12|(63&this.get(b2++))<<6|63&this.get(b2++))}return b3},t.prototype.parseStringBMP=function(b0,bZ){for(var b4="",b3=b0;bZ>b3;b3+=2){var b2=this.get(b3),b1=this.get(b3+1);b4+=String.fromCharCode((b2<<8)+b1)}return b4},t.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,t.prototype.parseTime=function(b0,bZ){var b2=this.parseStringISO(b0,bZ),b1=this.reTime.exec(b2);return b1?(b2=b1[1]+"-"+b1[2]+"-"+b1[3]+" "+b1[4],b1[5]&&(b2+=":"+b1[5],b1[6]&&(b2+=":"+b1[6],b1[7]&&(b2+="."+b1[7]))),b1[8]&&(b2+=" UTC","Z"!=b1[8]&&(b2+=b1[8],b1[9]&&(b2+=":"+b1[9]))),b2):"Unrecognized time: "+b2},t.prototype.parseInteger=function(b0,bZ){var b4=bZ-b0;if(b4>4){b4<<=3;var b3=this.get(b0);if(0===b3){b4-=8}else{for(;128>b3;){b3<<=1,--b4}}return"("+b4+" bit)"}for(var b2=0,b1=b0;bZ>b1;++b1){b2=b2<<8|this.get(b1)}return b2},t.prototype.parseBitString=function(b7,b6){var b5=this.get(b7),b4=(b6-b7-1<<3)-b5,b3="("+b4+" bit)";if(20>=b4){var b2=b5;b3+=" ";for(var b1=b6-1;b1>b7;--b1){for(var b0=this.get(b1),bZ=b2;8>bZ;++bZ){b3+=b0>>bZ&1?"1":"0"}b2=0}}return b3},t.prototype.parseOctetString=function(b0,bZ){var b3=bZ-b0,b2="("+b3+" byte) ";b3>bX&&(bZ=b0+bX);for(var b1=b0;bZ>b1;++b1){b2+=this.hexByte(this.get(b1))}return b3>bX&&(b2+=bW),b2},t.prototype.parseOID=function(b0,bZ){for(var b6="",b5=0,b4=0,b3=b0;bZ>b3;++b3){var b2=this.get(b3);if(b5=b5<<7|127&b2,b4+=7,!(128&b2)){if(""===b6){var b1=80>b5?40>b5?0:1:2;b6=b1+"."+(b5-40*b1)}else{b6+="."+(b4>=31?"bigint":b5)}b5=b4=0}}return b6},bY.prototype.typeName=function(){if(this.tag===z){return"unknown"}var bZ=this.tag>>6,b0=(this.tag>>5&1,31&this.tag);switch(bZ){case 0:switch(b0){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+b0.toString(16)}case 1:return"Application_"+b0.toString(16);case 2:return"["+b0+"]";case 3:return"Private_"+b0.toString(16)}},bY.prototype.reSeemsASCII=/^[ -~]+$/,bY.prototype.content=function(){if(this.tag===z){return null}var bZ=this.tag>>6,b3=31&this.tag,b2=this.posContent(),b1=Math.abs(this.length);if(0!==bZ){if(null!==this.sub){return"("+this.sub.length+" elem)"}var b0=this.stream.parseStringISO(b2,b2+Math.min(b1,bX));return this.reSeemsASCII.test(b0)?b0.substring(0,2*bX)+(b0.length>2*bX?bW:""):this.stream.parseOctetString(b2,b2+b1)}switch(b3){case 1:return 0===this.stream.get(b2)?"false":"true";case 2:return this.stream.parseInteger(b2,b2+b1);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(b2,b2+b1);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b2,b2+b1);case 6:return this.stream.parseOID(b2,b2+b1);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(b2,b2+b1);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(b2,b2+b1);case 30:return this.stream.parseStringBMP(b2,b2+b1);case 23:case 24:return this.stream.parseTime(b2,b2+b1)}return null},bY.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},bY.prototype.print=function(bZ){if(bZ===z&&(bZ=""),document.writeln(bZ+this),null!==this.sub){bZ+="  ";for(var b1=0,b0=this.sub.length;b0>b1;++b1){this.sub[b1].print(bZ)}}},bY.prototype.toPrettyString=function(bZ){bZ===z&&(bZ="");var b2=bZ+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(b2+="+"),b2+=this.length,32&this.tag?b2+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(b2+=" (encapsulates)"),b2+="\n",null!==this.sub){bZ+="  ";for(var b1=0,b0=this.sub.length;b0>b1;++b1){b2+=this.sub[b1].toPrettyString(bZ)}}return b2},bY.prototype.toDOM=function(){var b8=L.tag("div","node");b8.asn1=this;var b7=L.tag("div","head"),b6=this.typeName().replace(/_/g," ");b7.innerHTML=b6;var b5=this.content();if(null!==b5){b5=String(b5).replace(/</g,"&lt;");var b4=L.tag("span","preview");b4.appendChild(L.text(b5)),b7.appendChild(b4)}b8.appendChild(b7),this.node=b8,this.head=b7;var b3=L.tag("div","value");if(b6="Offset: "+this.stream.pos+"<br/>",b6+="Length: "+this.header+"+",b6+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?b6+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(b6+="<br/>(encapsulates)"),null!==b5&&(b6+="<br/>Value:<br/><b>"+b5+"</b>","object"==typeof oids&&6==this.tag)){var b2=oids[b5];b2&&(b2.d&&(b6+="<br/>"+b2.d),b2.c&&(b6+="<br/>"+b2.c),b2.w&&(b6+="<br/>(warning!)"))}b3.innerHTML=b6,b8.appendChild(b3);var b1=L.tag("div","sub");if(null!==this.sub){for(var b0=0,bZ=this.sub.length;bZ>b0;++b0){b1.appendChild(this.sub[b0].toDOM())}}return b8.appendChild(b1),b7.onclick=function(){b8.className="node collapsed"==b8.className?"node":"node collapsed"},b8},bY.prototype.posStart=function(){return this.stream.pos},bY.prototype.posContent=function(){return this.stream.pos+this.header},bY.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},bY.prototype.fakeHover=function(bZ){this.node.className+=" hover",bZ&&(this.head.className+=" hover")},bY.prototype.fakeOut=function(b0){var bZ=/ ?hover/;this.node.className=this.node.className.replace(bZ,""),b0&&(this.head.className=this.head.className.replace(bZ,""))},bY.prototype.toHexDOM_sub=function(b0,bZ,b4,b3,b2){if(!(b3>=b2)){var b1=L.tag("span",bZ);b1.appendChild(L.text(b4.hexDump(b3,b2))),b0.appendChild(b1)}},bY.prototype.toHexDOM=function(bZ){var b4=L.tag("span","hex");if(bZ===z&&(bZ=b4),this.head.hexNode=b4,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},b4.asn1=this,b4.onmouseover=function(){var b5=!bZ.selected;b5&&(bZ.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(b5)},b4.onmouseout=function(){var b5=bZ.selected==this.asn1;this.asn1.fakeOut(b5),b5&&(bZ.selected=null,this.className="hex")},this.toHexDOM_sub(b4,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(b4,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub){b4.appendChild(L.text(this.stream.hexDump(this.posContent(),this.posEnd())))}else{if(this.sub.length>0){var b3=this.sub[0],b2=this.sub[this.sub.length-1];this.toHexDOM_sub(b4,"intro",this.stream,this.posContent(),b3.posStart());for(var b1=0,b0=this.sub.length;b0>b1;++b1){b4.appendChild(this.sub[b1].toHexDOM(bZ))}this.toHexDOM_sub(b4,"outro",this.stream,b2.posEnd(),this.posEnd())}}return b4},bY.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},bY.decodeLength=function(b0){var bZ=b0.get(),b2=127&bZ;if(b2==bZ){return b2}if(b2>3){throw"Length over 24 bits not supported at position "+(b0.pos-1)}if(0===b2){return -1}bZ=0;for(var b1=0;b2>b1;++b1){bZ=bZ<<8|b0.get()}return bZ},bY.hasContent=function(bZ,b5,b4){if(32&bZ){return !0}if(3>bZ||bZ>4){return !1}var b3=new t(b4);3==bZ&&b3.get();var b2=b3.get();if(b2>>6&1){return !1}try{var b1=bY.decodeLength(b3);return b3.pos-b4.pos+b1==b5}catch(b0){return !1}},bY.decode=function(b8){b8 instanceof t||(b8=new t(b8,0));var b7=new t(b8),b6=b8.get(),b5=bY.decodeLength(b8),b4=b8.pos-b7.pos,b3=null;if(bY.hasContent(b6,b5,b8)){var b2=b8.pos;if(3==b6&&b8.get(),b3=[],b5>=0){for(var b1=b2+b5;b8.pos<b1;){b3[b3.length]=bY.decode(b8)}if(b8.pos!=b1){throw"Content size is not correct for container starting at offset "+b2}}else{try{for(;;){var b0=bY.decode(b8);if(0===b0.tag){break}b3[b3.length]=b0}b5=b2-b8.pos}catch(bZ){throw"Exception while decoding undefined length content: "+bZ}}}else{b8.pos+=b5}return new bY(b7,b4,b5,b6,b3)},bY.test=function(){for(var bZ=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],b3=0,b2=bZ.length;b2>b3;++b3){var b1=new t(bZ[b3].value,0),b0=bY.decodeLength(b1);b0!=bZ[b3].expected&&document.write("In test["+b3+"] expected "+bZ[b3].expected+" got "+b0+"\n")}},window.ASN1=bY}(),ASN1.prototype.getHexStringValue=function(){var z=this.toHexString(),t=2*this.header,L=2*this.length;return z.substr(t,L)},A.prototype.parseKey=function(b7){try{var b6=0,b5=0,b4=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,b3=b4.test(b7)?Hex.decode(b7):Base64.unarmor(b7),b2=ASN1.decode(b3);if(3===b2.sub.length&&(b2=b2.sub[2].sub[0]),9===b2.sub.length){b6=b2.sub[1].getHexStringValue(),this.n=w(b6,16),b5=b2.sub[2].getHexStringValue(),this.e=parseInt(b5,16);var b1=b2.sub[3].getHexStringValue();this.d=w(b1,16);var b0=b2.sub[4].getHexStringValue();this.p=w(b0,16);var bZ=b2.sub[5].getHexStringValue();this.q=w(bZ,16);var bY=b2.sub[6].getHexStringValue();this.dmp1=w(bY,16);var bX=b2.sub[7].getHexStringValue();this.dmq1=w(bX,16);var bW=b2.sub[8].getHexStringValue();this.coeff=w(bW,16)}else{if(2!==b2.sub.length){return !1}var L=b2.sub[1],z=L.sub[0];b6=z.sub[0].getHexStringValue(),this.n=w(b6,16),b5=z.sub[1].getHexStringValue(),this.e=parseInt(b5,16)}return !0}catch(t){return !1}},A.prototype.getPrivateBaseKey=function(){var z={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},t=new KJUR.asn1.DERSequence(z);return t.getEncodedHex()},A.prototype.getPrivateBaseKeyB64=function(){return ae(this.getPrivateBaseKey())},A.prototype.getPublicBaseKey=function(){var z={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},t=new KJUR.asn1.DERSequence(z);z={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var bX=new KJUR.asn1.DERSequence(z);z={hex:"00"+bX.getEncodedHex()};var bW=new KJUR.asn1.DERBitString(z);z={array:[t,bW]};var L=new KJUR.asn1.DERSequence(z);return L.getEncodedHex()},A.prototype.getPublicBaseKeyB64=function(){return ae(this.getPublicBaseKey())},A.prototype.wordwrap=function(z,t){if(t=t||64,!z){return z}var L="(.{1,"+t+"})( +|$\n?)|(.{1,"+t+"})";return z.match(RegExp(L,"g")).join("\n")},A.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},A.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},A.prototype.hasPublicKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")},A.prototype.hasPrivateKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},A.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)};var bx=function(t){A.call(this),t&&("string"==typeof t?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))};bx.prototype=new A,bx.prototype.constructor=bx;var a3=function(t){t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};a3.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new bx(t)},a3.prototype.setPrivateKey=function(t){this.setKey(t)},a3.prototype.setPublicKey=function(t){this.setKey(t)},a3.prototype.decrypt=function(z){try{return this.getKey().decrypt(aW(z))}catch(t){return !1}},a3.prototype.encrypt=function(z){try{return ae(this.getKey().encrypt(z))}catch(t){return !1}},a3.prototype.getKey=function(t){if(!this.key){if(this.key=new bx,t&&"[object Function]"==={}.toString.call(t)){return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t)}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},a3.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},a3.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},a3.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},a3.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};ap.JSEncrypt=a3})(JSEncryptExports);var JSEncrypt=JSEncryptExports.JSEncrypt;